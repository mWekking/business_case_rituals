version: 2

models:
  - name: fact_github_issues
    description: >-
      Fact table for GitHub issues. Grain: 1 row per issue (repo_owner, repo_name, issue_id).
    columns:
      - name: pk_issues
        description: A unique key generated from repo_owner, repo_name, and issue_id
        tests:
          - not_null
          - unique

      - name: fk_contributor
        description: Surrogate key for (repo_owner, repo_name, contributor_login)
        tests:
          - not_null
          - relationships:
              to: ref('dim_github_contributors')
              field: pk_contributor

      - name: repo_owner
        description: Repository owner
        tests:
          - not_null

      - name: repo_name
        description: Repository name
        tests:
          - not_null

      - name: issue_id
        description: GitHub issue id (stable primary key)
        tests:
          - not_null
          - unique

      - name: issue_number
        description: Issue number shown in GitHub UI (not globally unique)

      - name: issue_state
        description: Issue state from GitHub (open or closed)

      - name: title
        description: Issue title

      - name: author_login
        description: GitHub login of the issue author

      - name: author_type
        description: GitHub user type of the issue author (User, Bot, Organization)

      - name: created_at
        description: Timestamp when the issue was created

      - name: updated_at
        description: Timestamp when the issue was last updated

      - name: closed_at
        description: Timestamp when the issue was closed

      - name: comments_count
        description: Number of comments on the issue
